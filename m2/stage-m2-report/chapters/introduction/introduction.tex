\documentclass[../../main.tex]{subfiles} % Allows individual compilation
\graphicspath{{\subfix{./images/}}}

\begin{document}

\section{Objectives of the internship}
This report succintly presents the work done during the internship 
concluding the Master 2 program MVA - \textit{Math√©matiques, Vision, 
Apprentissage}. The internship was academic in nature, and lasted six months. 
It will be followed by a PhD thesis on the same subject, by the same intern, 
under the same advisors. Its general goals were, sequentially,
\begin{enumerate}[label=\raisenth*]
	\item To introduce the intern to the problem of community detection on 
	graphs. This consists on getting a firm understanding on the different 
	canonical approaches to the problem, gaining familiarity first with the 
	field's classical and recent research literature, and gaining probabilistic 
	as well as statistical intuitions that can be applied to related problems;
	\item To tackle a current research question, suggested by the advisors of 
	the internship;
	\item To apply the knowledge obtained to think of new research 
	directions autonomously.
\end{enumerate}

\section{Motivations for the internship}
The field of community detection on graphs is rich both in theory and in 
applications. In this section, the motivations for the field and for the 
particular problem of the internship are explained.

\subsection{Graphs with communities}
A graph is a mathematical object expressing the interaction between entities. 
One of the most interesting and relevant structures a graph can have 
is that of \textit{communities}. However, precisely defining this structure is 
subtle and not agreed upon. One common intuition is to think of it as a 
set of vertices having more connections among themselves than with all other 
vertices. Such an intuition is useful in many situations, and it is called an 
\textit{assortative} notion of community. In other cases, however, one's 
intuition of what such groups are does not fit the assortative case. Consider a 
party, where people dance in pairs. There are fifty men and fifty women, and 
assume that each man will pair up with some woman to dance. In this case, one 
can consider that there are two groups in the party, men and women. 
However, no two members of the same group connect. This is what is called 
an \textit{dissortative} notion of community, as its members share a 
\textit{pattern} of connection instead of denser connections. The conceptual 
difficulties do not stop here, as it may happen that the notion of what a 
community is depends on the \textit{scale} (i.e., the amount of ``zoom'' into 
the 
graph) considered. It is clear then that the problem of community detection on 
graphs, also called graph clustering, is delicate.

\subsection{Common approaches to community detection}

Assume an arbitrary graph is observed, with the sole hypothesis that in it 
there are communities, i.e., there exists some particular partition of the 
graph corresponding to community assignments. This hypothesis is deliberately 
vague. Consider the following common, yet very distinct, approaches to building 
algorithms to find such partition.

\subsubsection{Statistical approaches}
In \textit{statistical} approaches to community detection, one assumes that 
the communities assigned to nodes and the edges formed are random variables, 
and thus the graph observed arises as an observation of some model. One 
then analyzes its likelihood function to derive algorithms derived in order to 
estimate the model's parameters and infer the graph's communities. In this 
report, and in most recent research, the model assumed in this context is 
called the stochastic block model, or SBM for short. As it will be seen, 
directly computing the likelihood of an observation under such model is 
intractable, since doing so requires one to sum over all possible cluster 
assignments for the nodes. The number of terms in such a sum grows 
exponentially with the number of nodes, and there is no way to simplify it into 
a tractable form. A common way around this difficulty is to substitute the 
exact likelihood function by a variational approximation to it. This 
approximation can be built in various ways, the simplest one being the 
\textit{mean-field} approximation. The optimization problem that arises can in 
theory be solved by an alternating optimization algorithm akin to the classical 
EM algorithm, and is called the Variational EM.

\subsubsection{Optimization approaches}
In \textit{optimization} approaches to community 
detection, it is not assumed that 
the graph at hand is an observation of some (probabilistic) model. Instead, one 
derives algorithms based on heuristics and 
approximations to optimization
problems. One popular optimization problem for 
finding communities in graphs is the balanced 
min-cut problem, which searches for a partition 
such that the number of edges across classes is 
minimal. This agrees with the assortative intuition of 
what a community is. This problem is NP-hard and is 
popularly approximated by a relaxed version leading 
to the spectral clustering algorithm.

These spectral approaches can be seen as ways of 
embedding the graph in some vector space. In this 
vectorial representation of the graph, there are as 
many vectors as there are nodes, and as many 
dimensions as communities. In consequence, its 
dimensionality is typically low when compared to the 
complexity of the general graph representation. 
Moreover, under certain conditions, clustering the 
nodes in this representation (using classical vector 
space clustering algorithms such as k-means) could 
correspond to a clustering of nodes in the graph, 
thus revealing the communities.

\subsection{Learning theory}
These approaches are popular, but without a ground truth for the communities on 
the graph there is no way of measuring the accuracies of their results. In such 
an \textit{unsupervised} setting, the answer to the question of what are the 
graph's communities must be the output of the algorithm itself. 

One way of dealing with these difficulties is to consider a \textit{generative} 
model. This provides a definite ground truth assignment of communities to the 
nodes of a graph arising as an observation from such model. As a consequence, 
one can develop, measure the accuracy, and compare algorithms designed to 
recover these communities. Arguably, the most popular such model is called the 
Stochastic Block Model (SBM). Essentially, it randomly assigns communities to 
nodes and then connects any pair of them with a probability depending on the 
communities of the pair, see Figure \ref{fig:sbm-example}.

\subsection{Applications}
Data in the form of graphs and networks naturally appear in fields such as 
ecology, power grids, transportation systems, social networks, recommendation 
systems, neurology, telecommunications, and so on. Some interesting 
applications of community detection methods include the analysis of political 
blogospheres \cite{latouche_overlapping_2011}, 
analysis of criminal networks 
\cite{legramanti_extended_2022}, cell profiling \cite{morelli_nested_2021}, 
analysis of ecological networks \cite{miele_revealing_2017}, and so on. There 
is a growing abundance of network data openly available online. Some useful 
resources are \cite{newman-resources, pozo-resources, peixoto-resources, 
stanford-resources}.

This reports presents experiments performed in simulated data, as well as in 
real data coming from these sources.

\begin{comment}
	The mean-field approximation probabilistic approach and the graph Laplacian 
	spectral clustering were developed independently and had no known 
	connection. 
	In the former, one deals with a key object called the evidence lower bound 
	(ELBO). The question posed by the advisors at the beginning of 
	this internship was: \marginnote{\todo{Put this on the conclusion and focus 
	on 
			the 
			real problem. Then you explain why you did not have time due to 
			other things.}}
	
	\begin{center}
		\textit{Is it possible to somehow simplify the expression for the ELBO 
		in 
			Equation \eqref{eq:phi} in terms of the graph Laplacian, thus 
			linking the 
			probabilistic and spectral approaches ?}
	\end{center}
	
	Such a connection would have consequences of interest. For example, one 
	could be able to extend the probabilistic model selection procedure to the 
	spectral methods, giving them a principled way of picking the number of 
	clusters with which to run the k-means algorithm. Another example of 
	application of this connection would be the development of a ``spectral'' 
	notion of robustness. \marginnote{\todo{Write how k-means and EM match in 
	the 
			anisotropic case.}}
\end{comment}

\subsection{Note on contributions}
It is important to emphasize that this report aims to convey, beyond the effort 
put into answering any particular question, the view the intern ended up having 
of the field and the new challenges to be adressed as a continuation on his 
PhD. Several research problems were explored during these months. This was at 
times intentional, aiming to give the intern an understanding of the different 
open questions in the field, and at other times a result of the difficulty of 
the question at hand.

\begin{comment}
	It is structured as follows. The first chapter defines the 
	vanilla stochastic block model, and asymptotic ``recovery requirements'', 
	that 
	is, different measures of an algorithm's ability to find the communities on 
	a 
	given graph. The second chapter describes an approximation of the SBM 
	likelihood that allows one to derive an EM-like algorithm to maximize that 
	likelihood. The third chapter has two parts; the first one motivates and 
	derives the basic spectral clustering algorithm (for graph clustering), and 
	the 
	second explains when and why it asymptotically works for the \textit{dense} 
	SBM. The fourth chapter brings forward a problem that has occupied a large 
	portion of the field until recently, namely the search for understanding 
	why 
	spectral methods fail in the sparse regime and how to fix it. The fifth 
	chapter 
	adresses the matter of robustness of different methods for community 
	detection. 
	Finally, the sixth chapter shortly describes possibly interesting research 
	directions for the future.
\end{comment}

\begin{comment}
	\subsection{Acknowledgements}
	I would like to thank first and foremost my parents, who made it possible 
	to be 
	here today; I would like Bianca for making my days lighter and happier; I 
	would 
	like to thank Zacharie and Christine for being such supportive supervisors. 
\end{comment}

\end{document}

