(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     14257,        310]
NotebookOptionsPosition[     13311,        288]
NotebookOutlinePosition[     13705,        304]
CellTagsIndexPosition[     13662,        301]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellLabel->
  "In[296]:=",ExpressionUUID->"eb48678d-0b96-4b6d-b74e-c2af0c7864e7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "Parameters", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"NN", "=", "200"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"k", "=", "4"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[CapitalPi]", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "/", "4"}], ",", " ", 
       RowBox[{"1", "/", "4"}], ",", 
       RowBox[{"1", "/", "4"}], ",", 
       RowBox[{"1", "/", "4"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"\[CapitalGamma]", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Subscript", "[", 
         RowBox[{"\[Gamma]", ",", " ", "i", ",", " ", "j"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "1", ",", " ", "k"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", " ", "1", ",", " ", "k"}], "}"}]}], "]"}]}], ";"}],
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[CapitalGamma]", "=", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0.4", ",", " ", "0.1", ",", "0.05", ",", "0.1"}], "}"}], ",",
        "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"0.1", ",", " ", "0.6", ",", "0.1", ",", "0.05"}], "}"}], ",",
        "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"0.05", ",", " ", "0.1", ",", " ", "0.3", ",", "0.15"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"0.1", ",", "0.05", ",", "0.15", ",", " ", "0.3"}], "}"}]}], 
      "\[IndentingNewLine]", "}"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.863704692858199*^9, 3.863704802289671*^9}, {
   3.863705320650024*^9, 3.863705323423143*^9}, {3.863705602520805*^9, 
   3.863705623469162*^9}, {3.863705653865563*^9, 3.863705668888651*^9}, {
   3.8637057068307343`*^9, 3.863705707281228*^9}, {3.87230490293039*^9, 
   3.872304941670578*^9}, {3.872305082590783*^9, 3.872305101870543*^9}, {
   3.872305135986011*^9, 3.8723051404113607`*^9}, {3.8723091562423162`*^9, 
   3.872309156413424*^9}, {3.872309217949408*^9, 3.8723092188177643`*^9}, {
   3.8723093107263117`*^9, 3.8723093682541103`*^9}, 3.872309408851012*^9, {
   3.8723094839296837`*^9, 3.8723095516154413`*^9}, {3.872309720373839*^9, 
   3.872309722956225*^9}, {3.872309888439293*^9, 
   3.872309915594562*^9}},ExpressionUUID->"027b1d1e-a42a-43fc-9b7b-\
6840236c0bf8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Z", "=", 
   RowBox[{"RandomVariate", "[", 
    RowBox[{
     RowBox[{"MultinomialDistribution", "[", 
      RowBox[{"1", ",", "\[CapitalPi]"}], "]"}], ",", "NN"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"z", "=", 
   RowBox[{
    RowBox[{"Position", "[", 
     RowBox[{"Z", ",", " ", 
      RowBox[{"_", "?", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"#", " ", "!=", " ", "0"}], "&"}], ")"}]}]}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["\[Sigma]", "inv"], " ", "=", 
    RowBox[{"FindPermutation", "[", "z", "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"Brings", " ", 
    RowBox[{"Sort", "[", "z", "]"}], " ", "to", " ", "z"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]", "=", 
   RowBox[{"InversePermutation", "[", 
    SubscriptBox["\[Sigma]", "inv"], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Z", " ", "=", " ", 
   RowBox[{"Permute", "[", 
    RowBox[{"Z", ",", "\[Sigma]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[ScriptCapitalA]", "=", 
   RowBox[{"Z", ".", "\[CapitalGamma]", ".", 
    RowBox[{"Transpose", "[", "Z", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[ScriptCapitalD]", "=", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"Total", "[", 
     RowBox[{"\[ScriptCapitalA]", ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[ScriptCapitalL]", "=", 
   RowBox[{"\[ScriptCapitalD]", "-", "\[ScriptCapitalA]"}]}], ";"}]}], "Input",\

 CellChangeTimes->{{3.863704819575144*^9, 3.863704837935755*^9}, {
  3.863705116139176*^9, 3.863705251364563*^9}, {3.863705316992909*^9, 
  3.863705365398205*^9}, {3.863705852003146*^9, 3.863705874400038*^9}, {
  3.86374741519993*^9, 3.863747417995153*^9}, {3.863747626075363*^9, 
  3.863747668727682*^9}, {3.8637477550585403`*^9, 3.863747768805891*^9}, {
  3.8723049860154247`*^9, 3.872305061395471*^9}, {3.8723051282195683`*^9, 
  3.872305161950268*^9}, {3.872305243903882*^9, 3.872305274321741*^9}, {
  3.872305332219417*^9, 3.872305336021845*^9}},
 CellLabel->
  "In[301]:=",ExpressionUUID->"4e233ede-cf50-418f-879a-cc6f12a3f147"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"vals", ",", "vecs"}], "}"}], "=", 
   RowBox[{"Eigensystem", "[", "\[ScriptCapitalL]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.872305692225697*^9, 3.8723057002023277`*^9}, {
   3.8723086147611923`*^9, 3.8723086153982983`*^9}, {3.872308686474483*^9, 
   3.8723086870696993`*^9}, {3.872308815988181*^9, 3.872308845629051*^9}, {
   3.872308877967972*^9, 3.872308885126069*^9}, 3.872309014700885*^9},
 CellLabel->
  "In[309]:=",ExpressionUUID->"fa6a267a-3a89-488b-8dc3-4c1c5f9a3145"],

Cell[CellGroupData[{

Cell[BoxData["vals"], "Input",
 CellChangeTimes->{{3.872305799406241*^9, 3.872305802755714*^9}, {
  3.872309019062976*^9, 3.8723090193271093`*^9}},
 CellLabel->
  "In[310]:=",ExpressionUUID->"e65219a0-9399-48de-b172-072bc0a003c2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "44.700000000000124`", ",", "44.70000000000012`", ",", "44.70000000000011`",
    ",", "44.700000000000095`", ",", "44.700000000000095`", ",", 
   "44.70000000000009`", ",", "44.70000000000008`", ",", "44.70000000000008`",
    ",", "44.700000000000074`", ",", "44.700000000000074`", ",", 
   "44.700000000000074`", ",", "44.700000000000074`", ",", 
   "44.70000000000007`", ",", "44.70000000000007`", ",", "44.70000000000006`",
    ",", "44.70000000000006`", ",", "44.70000000000006`", ",", 
   "44.70000000000005`", ",", "44.70000000000005`", ",", 
   "44.700000000000045`", ",", "44.700000000000045`", ",", 
   "44.700000000000045`", ",", "44.700000000000045`", ",", 
   "44.70000000000004`", ",", "44.70000000000004`", ",", "44.70000000000004`",
    ",", "44.70000000000003`", ",", "44.70000000000003`", ",", 
   "44.700000000000024`", ",", "44.700000000000024`", ",", 
   "44.70000000000002`", ",", "44.70000000000002`", ",", "44.70000000000002`",
    ",", "44.70000000000002`", ",", "44.70000000000002`", ",", 
   "44.70000000000001`", ",", "44.70000000000001`", ",", "44.70000000000001`",
    ",", "44.70000000000001`", ",", "44.7`", ",", "44.7`", ",", 
   "44.699999999999996`", ",", "44.699999999999996`", ",", 
   "44.699999999999996`", ",", "44.69999999999999`", ",", 
   "44.69999999999999`", ",", "44.69999999999999`", ",", "44.69999999999999`",
    ",", "44.69999999999998`", ",", "44.69999999999998`", ",", 
   "44.699999999999974`", ",", "44.699999999999974`", ",", 
   "44.69999999999996`", ",", "31.100000000000108`", ",", 
   "31.100000000000104`", ",", "31.1000000000001`", ",", 
   "31.100000000000097`", ",", "31.100000000000097`", ",", 
   "31.100000000000094`", ",", "31.10000000000009`", ",", 
   "31.10000000000009`", ",", "31.10000000000009`", ",", "31.10000000000009`",
    ",", "31.100000000000087`", ",", "31.100000000000083`", ",", 
   "31.100000000000083`", ",", "31.10000000000008`", ",", 
   "31.100000000000076`", ",", "31.100000000000076`", ",", 
   "31.100000000000076`", ",", "31.100000000000076`", ",", 
   "31.100000000000072`", ",", "31.100000000000065`", ",", 
   "31.100000000000065`", ",", "31.100000000000062`", ",", 
   "31.100000000000062`", ",", "31.100000000000062`", ",", 
   "31.10000000000006`", ",", "31.100000000000055`", ",", 
   "31.100000000000055`", ",", "31.100000000000055`", ",", 
   "31.100000000000055`", ",", "31.10000000000005`", ",", 
   "31.10000000000005`", ",", "31.100000000000048`", ",", 
   "31.100000000000048`", ",", "31.100000000000044`", ",", 
   "31.100000000000044`", ",", "31.10000000000004`", ",", 
   "31.100000000000037`", ",", "31.100000000000033`", ",", 
   "31.100000000000033`", ",", "31.100000000000033`", ",", 
   "31.10000000000003`", ",", "31.100000000000023`", ",", 
   "31.100000000000012`", ",", "31.10000000000001`", ",", 
   "31.10000000000001`", ",", "30.80000000000002`", ",", "30.80000000000002`",
    ",", "30.80000000000001`", ",", "30.800000000000008`", ",", 
   "30.799999999999997`", ",", "30.799999999999997`", ",", 
   "30.799999999999997`", ",", "30.79999999999999`", ",", 
   "30.79999999999999`", ",", "30.799999999999986`", ",", 
   "30.799999999999983`", ",", "30.799999999999983`", ",", 
   "30.79999999999998`", ",", "30.79999999999998`", ",", 
   "30.799999999999976`", ",", "30.799999999999976`", ",", 
   "30.799999999999976`", ",", "30.799999999999972`", ",", 
   "30.799999999999972`", ",", "30.79999999999997`", ",", 
   "30.79999999999997`", ",", "30.79999999999997`", ",", "30.79999999999997`",
    ",", "30.79999999999996`", ",", "30.799999999999958`", ",", 
   "30.799999999999958`", ",", "30.799999999999955`", ",", 
   "30.79999999999995`", ",", "30.79999999999995`", ",", 
   "30.799999999999947`", ",", "30.799999999999944`", ",", 
   "30.799999999999944`", ",", "30.79999999999994`", ",", 
   "30.799999999999937`", ",", "30.799999999999937`", ",", 
   "30.799999999999937`", ",", "30.799999999999937`", ",", 
   "30.799999999999933`", ",", "30.79999999999993`", ",", 
   "30.79999999999993`", ",", "30.799999999999926`", ",", 
   "30.799999999999926`", ",", "30.799999999999926`", ",", 
   "30.799999999999923`", ",", "30.799999999999923`", ",", 
   "30.799999999999915`", ",", "30.799999999999912`", ",", 
   "30.799999999999905`", ",", "30.7999999999999`", ",", 
   "30.799999999999898`", ",", "30.799999999999898`", ",", 
   "30.799999999999894`", ",", "30.799999999999862`", ",", 
   "29.200000000000106`", ",", "29.200000000000085`", ",", 
   "29.200000000000074`", ",", "29.20000000000007`", ",", 
   "29.20000000000007`", ",", "29.200000000000063`", ",", 
   "29.200000000000056`", ",", "29.200000000000053`", ",", 
   "29.200000000000053`", ",", "29.20000000000005`", ",", 
   "29.200000000000045`", ",", "29.200000000000045`", ",", 
   "29.200000000000045`", ",", "29.200000000000042`", ",", 
   "29.20000000000004`", ",", "29.200000000000035`", ",", 
   "29.20000000000003`", ",", "29.20000000000003`", ",", "29.20000000000003`",
    ",", "29.200000000000028`", ",", "29.200000000000028`", ",", 
   "29.200000000000024`", ",", "29.20000000000002`", ",", 
   "29.200000000000017`", ",", "29.200000000000017`", ",", 
   "29.20000000000001`", ",", "29.20000000000001`", ",", "29.20000000000001`",
    ",", "29.20000000000001`", ",", "29.200000000000006`", ",", 
   "29.200000000000006`", ",", "29.200000000000003`", ",", "29.2`", ",", 
   "29.199999999999996`", ",", "29.199999999999996`", ",", 
   "29.199999999999992`", ",", "29.199999999999992`", ",", 
   "29.19999999999999`", ",", "29.199999999999985`", ",", 
   "29.199999999999985`", ",", "29.19999999999998`", ",", 
   "29.19999999999998`", ",", "29.19999999999998`", ",", 
   "29.199999999999974`", ",", "29.19999999999997`", ",", 
   "23.524202037341208`", ",", "16.475797962658866`", ",", 
   "15.000000000000043`", ",", "1.4210854715202004`*^-14"}], "}"}]], "Output",\

 CellChangeTimes->{
  3.872305803209198*^9, 3.872309020363549*^9, {3.8723091200651913`*^9, 
   3.8723091600926*^9}, 3.872309222367446*^9, 3.872309426359482*^9, {
   3.8723095467595787`*^9, 3.8723095540576353`*^9}, 3.8723097267480307`*^9},
 CellLabel->
  "Out[310]=",ExpressionUUID->"60e415e6-f320-49e1-9b84-f1f114f091d6"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Chop", "[", 
   RowBox[{
    RowBox[{"MatrixForm", "[", 
     RowBox[{"vecs", "\[Transpose]"}], "]"}], ",", 
    RowBox[{"10", "^", 
     RowBox[{"(", 
      RowBox[{"-", "10"}], ")"}]}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.872307796150629*^9, 3.8723078725761538`*^9}, {
   3.8723080886911373`*^9, 3.872308092889785*^9}, {3.872308141423613*^9, 
   3.8723081441095037`*^9}, {3.872308174289364*^9, 3.87230818372469*^9}, {
   3.872308942282049*^9, 3.87230895848437*^9}, {3.872309026033764*^9, 
   3.872309026833005*^9}, {3.872309186033368*^9, 3.8723091999420633`*^9}, {
   3.872309625428462*^9, 3.872309625657447*^9}, 3.872309714286491*^9},
 CellLabel->
  "In[311]:=",ExpressionUUID->"a715c8e0-0456-43af-8111-5291cb86c125"]
},
WindowSize->{640, 772},
WindowMargins->{{Automatic, 0}, {Automatic, 0}},
FrontEndVersion->"13.0 for Mac OS X x86 (64-bit) (December 2, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"e5afd3cd-42ec-4637-a2e3-fe003300eb6e"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 159, 3, 30, "Input",ExpressionUUID->"eb48678d-0b96-4b6d-b74e-c2af0c7864e7"],
Cell[720, 25, 2431, 55, 241, "Input",ExpressionUUID->"027b1d1e-a42a-43fc-9b7b-6840236c0bf8"],
Cell[3154, 82, 2330, 60, 178, "Input",ExpressionUUID->"4e233ede-cf50-418f-879a-cc6f12a3f147"],
Cell[5487, 144, 552, 11, 30, "Input",ExpressionUUID->"fa6a267a-3a89-488b-8dc3-4c1c5f9a3145"],
Cell[CellGroupData[{
Cell[6064, 159, 230, 4, 30, "Input",ExpressionUUID->"e65219a0-9399-48de-b172-072bc0a003c2"],
Cell[6297, 165, 6228, 102, 417, "Output",ExpressionUUID->"60e415e6-f320-49e1-9b84-f1f114f091d6"]
}, Open  ]],
Cell[12540, 270, 767, 16, 30, "Input",ExpressionUUID->"a715c8e0-0456-43af-8111-5291cb86c125"]
}
]
*)

